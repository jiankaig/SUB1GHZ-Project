<!DOCTYPE html><html><meta name= "viewport"    content="width=device-width, initial-scale=1" >
<link rel="stylesheet"    href="https://www.w3schools.com/w3css/4/w3.css"   >
<link rel="stylesheet" href="{{ url_for('static',filename='css/sidebar.css') }}">
<head>
    <style>
        table {
            font-family: arial, sans-serif;
            border-collapse: collapse;
            width: 80%;
        }

        td, th {
            border: 1px solid #000000;
            text-align: left;
            padding: 8px;
        }
        .dot {
              height: 25px;
              width: 25px;
              background-color: #7214;
              border-radius: 50%;
              display: inline-block;
            }
    </style>
</head>
<body> <!--  Start of body tag -->

<div class="sidebar" > <!-- SideBar tab-->
<h3 class="w3-bar-item" style="border-bottom: 2px solid black;text-align: center;">Product</h3>  <!--  Title of sideBar tab-->
<a href="/" >PC00001</a> <!--  First SideBar Menu-->
<a href="/device2" style="background-color: darkgray;" >PC00002</a> <!--  Second SideBar Menu-->
<a href="#" >PC00003</a> <!--  Third SideBar Menu-->
</div>   <!--  End of SideBar tab -->

<div class="content"   >              <!--  Contents beside the sidebar should be within this div-->

<div class="w3-container w3-teal">                                   <!--  Header div line -->
<h1 align=center><font>Pick To Light</font></h1>  <!--Header -->
</div>                                                                    <!--  End of Header div-->

<div class="w3-container"   >              <!--  Div for each device-->
<h2 align=center> PC00002</h2>   <!--  Deivce header-->


<table>
  <tr>
    <th>Parts</th>
    <th>Color Picker</th>
    <th>LED Lights</th>
  </tr>
  {% for device in devices %}
  <tr>
    <td>{{device['Device_Name']}}</td>
    <td><input type="color" id="{{device['Device_ID']}}" class="tableColor"><!--  Color Picker--></td>
    <td style="text-align:center" ><span class="dot"></span></td>
  </tr>
  {% endfor %}
</table>
<br>
<button id="submitTable">Submit</button>
<br>
<h3>RED LED</h3>Output:                                           <!--  RED LED Header-->
<button value="AAX00020R255G000B000BB" onclick="individualBtnLED(this)"  >HIGH</button>       <!--  High Button for RED LED-->
<button value="AAX00020R000G000B000BB" onclick="individualBtnLED(this)"  >LOW</button><br>    <!--  High Button for RED LED-->
<hr style="height:2px;background-color:black"  >                  <!--  Line -->

<h3>Green LED</h3>Output:                                         <!--  GREEN LED Header-->
<button value="AAX00020R000G255B000BB" onclick="individualBtnLED(this)"   >HIGH</button>     <!--  High Button for GREEN LED-->
<button value="AAX00020R000G000B000BB" onclick="individualBtnLED(this)"   >LOW</button><br>  <!--  Low Button for GREEN LED-->
<hr style="height:2px;background-color:black"   >                  <!--  Line-->

<h3>Blue LED</h3>Output:                                            <!--  YELLOW LED Header-->
<button value="AAX00020R000G000B255BB" onclick="individualBtnLED(this)"   >HIGH</button>        <!--  High Button for YELLOW LED-->
<button value="AAX00020R000G000B000BB" onclick="individualBtnLED(this)"  >LOW</button><br>     <!--  Low Button for YELLOW LED-->
<hr style="height:2px;background-color:black"   >                      <!--  Line-->

<h3>RGB</h3>Output:                                                   <!--  Color Picker Header-->
<input type="color" id="second"><br><br>                          <!--  Color Picker-->
<button id="submitVal"> Submit </button>                       <!--  Submit button-->
<hr style="height:2px;background-color:black"   >                      <!--  Line-->


<h3>Command</h3>                                                      <!--  Command Header-->
<!-- AAX00010R255G255B000BB<input type="text" id="command">  -->
AAX000<input type="text" id="deviceNumber"   >
0R<input type="text" id="redVal"   >
G<input type="text" id="greenVal"   >
B<input type="text" id="blueVal"  >
BB
<br><br>                                                              <!--  Textarea-->
<button onclick=textInputFunc()> Submit </button>                     <!--  Submit button-->
<hr style="height:2px;background-color:black"   >                      <!--  Line-->

<h3>Command</h3>                                                      <!--  Command Header-->
<input type="textarea" id="command"><br><br>                      <!--  Textarea-->
<button onclick=commandFunction()> Submit </button>                   <!--  Submit button-->
<hr style="height:2px;background-color:black "  >                      <!--  Line-->

</div>                                                                <!--  End of Device 1 div-->
<!--  End of Content Div-->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

<script type="text/javascript">                                                                            //  JavaScript-->

function individualBtnLED(element){
alert(element.value);
$.ajax({
  data : {
            rgbValues:element.value,
            deviceID: 1
          },                  //  Send over to flask
  type : 'GET',
  url : '/individualBtnLED'
  })
}


function rgbFunction() {    //  rbgFunction
  var colorCode = (document.getElementById("rgbVal").value).substring(1);     //  Get Hex value of color-->
  alert(colorCode);
  var test ="RGBVal=";                                                           //  Assign URL path to var test-->
  var URL = test.concat(colorCode) ;                                                  //  Concat hex color code to URL path-->
  location.href=URL  ;                                                                //  Redirect to URL-->-->
}                                                                                   //  End of rgbFunction-->

function textInputFunc() {                                                                      //  textInputFunc -->
  var deviceNumber = String(document.getElementById("deviceNumber").value);                     //  Get inputs by user through the input ID-->
  var redRGB = String(document.getElementById("redVal").value);                                 //  Get inputs by user through the input ID-->
  if(redRGB.length<3){
      if(redRGB.length==2){
      redRGB="0"+redRGB;
      }else{
      redRGB="00"+redRGB;
      }
  }

  var greenRGB = String(document.getElementById("greenVal").value);                             //  Get inputs by user through the input ID-->
  if(greenRGB.length<3){
      if(greenRGB.length==2){
      greenRGB="0"+greenRGB;
      }else{
      greenRGB="00"+greenRGB;
      }
  }

  var blueRGB = String(document.getElementById("blueVal").value);                               //  Get inputs by user through the input ID-->
  if(blueRGB.length<3){
      if(blueRGB.length==2){
      blueRGB="0"+blueRGB;
      }else{
      blueRGB="00"+blueRGB;
      }
  }

  var rgbValues = "AAX000"+deviceNumber+"0R"+redRGB+"G"+greenRGB+"B"+blueRGB+"BB";     //  Join the strings together-->
  alert(rgbValues);
  $.ajax({                        //  Send over to flask
  data : {
          rgbValues:rgbValues,
          deviceID: deviceNumber
        },
  type : 'GET',
  url : '/textPart'
  })                                                                   //  Redirect to URL-->
}                                                                                               //  End of textInputFunc-->

  function commandFunction() {                                                                    //  commandFunction -->
  var rgbValues = String(document.getElementById("command").value);                               //  Get inputs by user through the input ID-->
  var id = rgbValues.slice(3,12)
  id = parseInt(id)
  alert(rgbValues);
  $.ajax({                        //  Send over to flask
  data : {
            rgbValues:rgbValues,
            deviceID: id
          },
  type : 'GET',
  url : '/fullCmd'
  })                                                                       //  Redirect to URL-->
  }                                                                                               //  End of commandFunction-->

  function hexToRgb(hex) {                                                                        //  Convert hex in color picker device 2 to rgb
    var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    return result ? {
      r: parseInt(result[1], 16),
      g: parseInt(result[2], 16),
      b: parseInt(result[3], 16)
    } : null;
  }




  $(document).ready(function() {                                                                  // AJAX jquery
    $("#submitVal").click(function(){
      hexValues = $("#second").val();

      redVal = hexToRgb(hexValues).r;                                                             //  Pad red with '0's
      if (redVal<100){
          if(redVal<10){
          redVal = "00"+redVal.toString();
          }else{
          redVal = "0"+redVal.toString();
          }
      }

      greenVal = hexToRgb(hexValues).g;                                                           //  Pad green with '0's

      if (greenVal<100){
          if(greenVal<10){
          greenVal = "00"+greenVal.toString();
          }else{
          greenVal = "0"+greenVal.toString();
          }
      }

      blueVal = hexToRgb(hexValues).b                                                             //  Pad green with '0's
      if (blueVal<100){
          if(blueVal<10){
          blueVal = "00"+blueVal.toString();
          }else{
          blueVal = "0"+blueVal.toString();
          }
      }
      //rgbValues = redVal.toString()+greenVal.toString()+blueVal.toString();
      rgbValues = "AAX00020R" + redVal.toString() + "G" + greenVal.toString() + "B" + blueVal.toString() + "BB" //    Combine into string
      alert(rgbValues);
      $.ajax({                        //  Send over to flask
      data : {
          rgbValues:rgbValues,
          deviceID: 2
        },
      type : 'GET',
      url : '/singleSubmit'
      })
    });

  // Table RGB values

  $("#submitTable").click(function(){                                                           //  When button of the table is clicked
    var cmdArray = [];
    var data = document.getElementsByClassName("tableColor");                                               //  Create a array of values by class of input
    console.log(data);
    for (var x =0; x< data.length; x++) {
    hexValues = data[x].value;
    id = data[x].id;

    redVal = hexToRgb(hexValues).r;                                                             //  Pad red with '0's
    if (redVal<100){
        if(redVal<10){
        redVal = "00"+redVal.toString();
        }else{
        redVal = "0"+redVal.toString();
        }
    }

    greenVal = hexToRgb(hexValues).g;                                                           //  Pad green with '0's

    if (greenVal<100){
        if(greenVal<10){
        greenVal = "00"+greenVal.toString();
        }else{
        greenVal = "0"+greenVal.toString();
        }
    }

    blueVal = hexToRgb(hexValues).b                                                             //  Pad green with '0's
    if (blueVal<100){
        if(blueVal<10){
        blueVal = "00"+blueVal.toString();
        }else{
        blueVal = "0"+blueVal.toString();
        }
    }
    //rgbValues = redVal.toString()+greenVal.toString()+blueVal.toString();
    rgbValues = "AAX000"+ id + "0R" + redVal.toString() + "G" + greenVal.toString() + "B" + blueVal.toString() + "BB" //    Combine into string

    cmdArray.push({rgbValues:rgbValues,id:id});
    console.log(cmdArray)
    };

    $.ajax({                        //  Send over to flask
      type : 'POST',
      url : '/rgbVal',
      data : JSON.stringify(cmdArray),
      contentType: "application/json",
      dataType: 'json'
      })
  });

  // elements = document.getElementsByTagName("td")
  //         for (var i = elements.length; i--;) {
  //             if (elements[i].innerHTML === "Under maintenance") {
  //             elements[i].style.color = "red";
  //             }
  //         }
});
  </script>
  </body>